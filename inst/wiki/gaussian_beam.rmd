## Near-field profile under gaussian-beam illumination
_baptiste Augui√© -- `r format(Sys.time(), "%d %B, %Y")`_
```{r demo, message=FALSE, echo=FALSE}
knitr::read_chunk("gaussian_beam.R")
```
Using the angular spectrum decomposition of a gaussian beam in a bundle of plane waves, the near-field profile is calculated on the transmitted side of a thin metal film illuminated under total internal reflection.

```{r load, echo=FALSE,results='hide'}
```

```{r setup, results='hide', echo=FALSE}
```

## Depth profile

```{r depth}
```
We observe that the field decays exponentially away from the interface with the same characteristic distance across the beam profile.

## Coupling to SPPs

The detrimental effect of the beam size on the field enhancement can be quite dramatic, as soon as the spread of incident angles causes the coupling to SPPs to deteriorate. Here we simulate the LFIEF for silver, with a beam waist varying from 1mm down to 1 micron.

```{r waist}
```

## Beam shift
Under total-internal reflection, the beam undergoes a spatial displacement known as Goos-Hanshen shift. The centre of the beam is displaced from the origin. With the metal layer, we can also excite SPPs which will propagate along the interface as far as tens of microns, depending on the losses.

```{r GH}
```

## 2D map

We can calculate the field at a grid of points in 2D or 3D. Here is the result for a slice at $z=10$nm.

```{r map}
```

```{r volume, rgl=TRUE}
```




